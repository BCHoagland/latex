\documentclass[twoside,10pt]{article}
\usepackage{/Users/bradenhoagland/latex/styles/toggles}
%\toggletrue{sectionbreaks}
%\toggletrue{sectionheaders}
\newcommand{\docTitle}{Math 412 - HW 9}
\usepackage{/Users/bradenhoagland/latex/styles/common}
\importStyles{modern}{rainbow}{boxy}

%\renewcommand{\theenumi}{\alph{enumi}}

\begin{document}
%\tableofcontents

% ------------------------------
% problem 1
% ------------------------------
\begin{exer}[Lesson 17, 5 points]
	Let $X$ be a nonempty set and $\phi: X \to \mathcal{H}$ a feature map into a Hilbert space $\mathcal{H}$. Define $k: X \times X \to \R$ by $k(x, y) = \langle \phi(x), \varphi(y) \rangle$ for every $x, y \in X$. Prove $k$ is a kernel.
\end{exer}

In order to be a kernel, $k$ must be symmetric and positive definite. These checks amount to just using the properties of inner products, which are
\begin{enumerate}
	\item $\ang{x,y}=\ang{x,y}$;
	\item $\ang{\alpha x + \beta y, z} = \alpha \ang{x,z}+ \beta\ang{y,z}$; and
	\item $\ang{x,x} \geq 0$, with $\ang{x,x}=0 \iff x=0$.
\end{enumerate}

\textbf{Symmetric:} Since inner products are symmetric (property (1) above),
\[
	k(x,y) = \ang{\phi(x), \phi(y)} = \ang{\phi(y), \phi(x)} = k(y,x).
\] 

\textbf{Positive definite:} Fix arbitrary ${a}_{1}, \dots, {a}_{n} \in \R$ and ${x}_{1}, \dots, {x}_{n} \in X$, then we want to show $\sum_{i,j} a_i a_j k(x_i, x_j) \geq 0$. From the properties of inner products,
\begin{align*}
	\sum_{i,j} a_i a_j k(x_i, x_j) &= \sum_{i,j}a_i a_j \ang{\phi(x_i),\; \phi(x_j)} \\
				       &= \sum_i a_i \sum_j a_j \Ang{\phi(x_i),\; \phi(x_j)} \\
				       &= \sum_i a_i \Ang{\phi(x_i),\; \sum_j a_j \phi(x_j)} \tag{by property 2} \\
				       &= \Ang{\sum_i a_i \phi(x_i),\; \sum_j a_j \phi(x_j)}. \tag{by property 2}
				       \intertext{Since both $i$ and $j$ range over the same values, both sums are the same. Thus this becomes}
				       &= \Ang{\sum_i a_i \phi(x_i),\; \sum_i a_i \phi(x_i)} \\
				       &\geq 0. \tag{by property 3}
\end{align*}


\newpage

% ------------------------------
% problem 2
% ------------------------------
\begin{exer}[Lesson 18, 5 points]
	Prove using the Schoenberg Theorem that the function 
	\[
	k(x, y) = e^{\frac{-\| x - y \|^2}{2\sigma^2}},\ x, y \in \R^d
	\]
	is a kernel on $\R^d$ for every $\sigma^2 > 0$.
\end{exer}

For this problem, $f(x,y)$ from the Schenberg theorem is
\[
	f(x,y) = {\Vert{x-y}\Vert}^{2}.
\] We must show that this $f$ is symmetric and CNSD.

\textbf{Symmetric:} Our $f$ is symmetric since
\[
	f(x,y) = {\Vert{x-y}\Vert}^{2} = \left( -1 \; {\Vert{x-y}\Vert} \right)^{2} = {\Vert{y-x}\Vert}^2 = f(y,x).
\] 

\textbf{CNSD:} Let $\alpha_{1}, \dots, \alpha_{n} \in \R$ such that $\sum_i \alpha_i = 0$, and let $x_1, \dots x_{n} \in X$. Then
\begin{align*}
	\sum_{i,j}\alpha_{i}\alpha_{j} {\Vert{x_i - x_j}\Vert}^{2} &= \sum_{i} \alpha_{i}\left( \sum_{j} \alpha_{j} {\Vert{x_i-x_j}\Vert}^{2} \right) \\
								   &\leq \sum_{i}\alpha_{i} \left( \sum_{j}\alpha_{j} \left( {\Vert{x_i}\Vert}+{\Vert{x_j}\Vert} \right)^{2} \right) \\
								   &\leq \sum_{i}\alpha_{i} \left( \sum_{j}a_{j} \left( \sum_{k}{\Vert{x_{k}}\Vert} \right)^{2} \right) \\
								   &= \sum_{i}\alpha_{i} \left( \left( \sum_{k}{\Vert{x_{k}}\Vert} \right)^{2} \left( \sum_{j}\alpha_{j} \right) \right) \\
								   &= 0,
\end{align*}
where the last equality follows from $\sum_{j}\alpha_{j}=0$.

\end{document}
